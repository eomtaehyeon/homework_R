---
title: "Example_10_2"
author: "Eom_Taehyeon"
date: '2022-03-13'
output: 
  html_document:
    keep_md: true 
---




# 사례 분석 10-2 수도권 지하철 승하차 인원 분석

## 1. 데이터 전처리



### 1) 파일 불러오기

```r
library(dplyr)
```

```
## Warning: 패키지 'dplyr'는 R 버전 4.1.3에서 작성되었습니다
```

```
## 
## 다음의 패키지를 부착합니다: 'dplyr'
```

```
## The following objects are masked from 'package:stats':
## 
##     filter, lag
```

```
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

```r
library(ggplot2)
```

```
## Warning: 패키지 'ggplot2'는 R 버전 4.1.3에서 작성되었습니다
```

```r
subway <- read.csv("subway_2005.csv", stringsAsFactors = F)
str(subway)
```

```
## 'data.frame':	18327 obs. of  6 variables:
##  $ 사용일자    : int  20200501 20200501 20200501 20200501 20200501 20200501 20200501 20200501 20200501 20200501 ...
##  $ 노선명      : chr  "중앙선" "중앙선" "중앙선" "중앙선" ...
##  $ 역명        : chr  "운길산" "팔당" "도심" "덕소" ...
##  $ 승차총승객수: int  1349 1492 1691 4303 645 6006 9135 967 5584 4606 ...
##  $ 하차총승객수: int  1358 1712 1462 4233 599 5562 9495 992 5317 4431 ...
##  $ 등록일자    : int  20200504 20200504 20200504 20200504 20200504 20200504 20200504 20200504 20200504 20200504 ...
```

### 2) 분석 변수 추출하고 이름 변경

```r
subway <- subway%>%
  rename(date="사용일자",
         line="노선명",
         station="역명",
         on_passenger="승차총승객수",
         off_passenger="하차총승객수")%>%
  select(-"등록일자")
```

### 3) 변수의 이상치와 결측치 확인하고 처리하기

```r
summary(subway)
```

```
##       date              line             station           on_passenger  
##  Min.   :20200501   Length:18327       Length:18327       Min.   :    1  
##  1st Qu.:20200508   Class :character   Class :character   1st Qu.: 2958  
##  Median :20200516   Mode  :character   Mode  :character   Median : 6219  
##  Mean   :20200516                                         Mean   : 9009  
##  3rd Qu.:20200524                                         3rd Qu.:11656  
##  Max.   :20200531                                         Max.   :92741  
##  off_passenger  
##  Min.   :    0  
##  1st Qu.: 2866  
##  Median : 6038  
##  Mean   : 8978  
##  3rd Qu.:11566  
##  Max.   :93572
```


### 4) 변수를 분석에 맞게 정리하고 파생변수 만들기

#### (1) date 변수


```r
subway$day<-substr(subway$date,7,8)

class(subway$day)
```

```
## [1] "character"
```

```r
subway$day <-as.integer(subway$day)
```

#### (2) line 변수


```r
table(subway$line)
```

```
## 
##          1호선          2호선          3호선          4호선          5호선 
##            310           1550           1043            806           1581 
##          6호선          7호선          8호선          9호선   9호선2~3단계 
##           1167           1581            527            775            403 
##         경강선         경부선         경원선         경의선         경인선 
##            341           1209            909            815            620 
##         경춘선 공항철도 1호선         과천선         분당선         수인선 
##            589            434            248           1063            403 
##         안산선     우이신설선         일산선         장항선         중앙선 
##            403            403            310            186            651
```

```r
subway$line<-ifelse(subway$line=="9호선2~3단계","9호선",subway$line)
```

#### (3) station 변수


```r
table(subway$station)
```

```
## 
##                  4.19민주묘지                          가능 
##                            31                            31 
##                      가락시장                가산디지털단지 
##                            62                            62 
##                          가양                        가오리 
##                            31                            31 
##                          가좌                        가천대 
##                            31                            31 
##                          가평                          간석 
##                            31                            31 
##                          갈매                          강남 
##                            31                            31 
##                      강남구청                          강동 
##                            62                            31 
##                      강동구청                          강매 
##                            31                            31 
##            강변(동서울터미널)                          강촌 
##                            31                            31 
##                          개롱                          개봉 
##                            31                            31 
##                        개포동                          개화 
##                            31                            31 
##                        개화산                          거여 
##                            31                            31 
##                      건대입구                          검암 
##                            62                            35 
##                      경기광주                      경마공원 
##                            31                            31 
##          경복궁(정부서울청사)                      경찰병원 
##                            31                            31 
##                          계양                          고덕 
##                            35                            31 
##                  고려대(종암)                    고속터미널 
##                            31                            93 
##                          고잔                          곡산 
##                            31                            31 
##                        곤지암                          공덕 
##                            31                           124 
##          공릉(서울과학기술대)                      공항시장 
##                            31                            31 
##                  공항화물청사                          과천 
##                            31                            31 
##                          관악                광나루(장신대) 
##                            31                            31 
##                          광명                    광명사거리 
##                            31                            31 
##                        광운대          광화문(세종문화회관) 
##                            31                            31 
##                  광흥창(서강)             교대(법원.검찰청) 
##                            31                            62 
##                          구로                구로디지털단지 
##                            31                            31 
##                          구룡                          구리 
##                            31                            31 
##                        구반포                          구산 
##                            31                            31 
##                          구성                구의(광진구청) 
##                            31                            31 
##                          구일                        구파발 
##                            31                            31 
##                          국수                    국회의사당 
##                            31                            31 
##                    군자(능동)                          군포 
##                            62                            31 
##                        굴봉산                        굴포천 
##                            31                            31 
##      굽은다리(강동구민회관앞)                          금곡 
##                            31                            31 
##                          금릉                          금정 
##                            31                            31 
##                      금천구청                          금촌 
##                            31                            31 
##                          금호                          기흥 
##                            31                            31 
##                          길동                          길음 
##                            31                            31 
##                        김유정                      김포공항 
##                            31                            93 
##                        까치산                        까치울 
##                            31                            31 
##                낙성대(강감찬)                        남구로 
##                            31                            31 
##                남동인더스파크        남부터미널(예술의전당) 
##                            31                            31 
##                          남성                          남영 
##                            31                            31 
##                        남춘천                        남태령 
##                            31                            31 
## 남한산성입구(성남법원.검찰청)                          내방 
##                            31                            31 
##                          노들                        노량진 
##                            31                            62 
##                          노원                          녹번 
##                            62                            31 
##              녹사평(용산구청)                          녹양 
##                            31                            31 
##                          녹천                          논현 
##                            31                            31 
##                          능곡                    단대오거리 
##                            31                            31 
##                          달월                        답십리 
##                            31                            31 
##                        당고개                          당산 
##                            31                            62 
##                          당정                          대곡 
##                            31                            31 
##                        대공원                대림(구로구청) 
##                            31                            62 
##                    대모산입구                          대방 
##                            31                            31 
##                        대성리                        대야미 
##                            31                            31 
##                          대청                          대치 
##                            31                            31 
##                          대화                대흥(서강대앞) 
##                            31                            31 
##                          덕계                          덕소 
##                            31                            31 
##                          덕정                          도곡 
##                            31                            62 
##                          도농                        도림천 
##                            31                            31 
##                          도봉                        도봉산 
##                            31                            62 
##                          도심                          도원 
##                            31                            31 
##                          도화                        독립문 
##                            31                            31 
##                        독바위                          독산 
##                            31                            31 
##                        돌곶이                        동대문 
##                            31                            62 
##       동대문역사문화공원(DDP)                      동대입구 
##                            93                            31 
##                        동두천                    동두천중앙 
##                            31                            31 
##                        동묘앞                          동암 
##                            62                            31 
##                        동인천                  동작(현충원) 
##                            31                            62 
##                          두정                        둔촌동 
##                            31                            31 
##                      둔촌오륜                          등촌 
##                            31                            31 
##              디지털미디어시티                          뚝섬 
##                            93                            31 
##                    뚝섬유원지                          마곡 
##                            31                            31 
##          마곡나루(서울식물원)                          마두 
##                            62                            31 
##                          마들                          마석 
##                            31                            31 
##                          마장                          마천 
##                            31                            31 
##                          마포                      마포구청 
##                            31                            31 
##                          망우                          망원 
##                            31                            31 
##                        망월사                          망포 
##                            31                            31 
##                          매교                          매봉 
##                            31                            31 
##                      매탄권선                          먹골 
##                            31                            31 
##                          면목                          명동 
##                            31                            31 
##                          명일                          명학 
##                            31                            31 
##                          모란                          목동 
##                            62                            31 
##            몽촌토성(평화의문)                        무악재 
##                            31                            31 
##                          문래                          문산 
##                            31                            31 
##                          문정                          미금 
##                            31                            31 
##          미아(서울사이버대학)                    미아사거리 
##                            31                            31 
##                          반월                          반포 
##                            31                            31 
##                          발산                          방배 
##                            31                            31 
##                          방이                          방학 
##                            31                            31 
##                          방화                          배방 
##                            31                            31 
##                          백마                          백석 
##                            31                            31 
##                        백양리                          백운 
##                            31                            31 
##                      버티고개                          범계 
##                            31                            31 
##                          별내                          병점 
##                            31                            31 
##                        보라매                          보문 
##                            31                            62 
##                          보산                          보정 
##                            31                            31 
##                          복정                          봉명 
##                            40                            31 
##                        봉은사                          봉천 
##                            31                            31 
##            봉화산(서울의료원)                          부개 
##                            31                            31 
##                          부발                          부천 
##                            31                            31 
##                      부천시청                부천종합운동장 
##                            31                            31 
##                          부평                      부평구청 
##                            31                            31 
##                  북한산보국문                    북한산우이 
##                            31                            31 
##                          불광                        사가정 
##                            62                            31 
##                          사당                          사릉 
##                            62                            31 
##                          사평                          산본 
##                            31                            31 
##                          산성                        삼각지 
##                            31                            62 
##                          삼동                    삼산체육관 
##                            31                            31 
##                삼성(무역센터)                      삼성중앙 
##                            31                            31 
##                          삼송                          삼양 
##                            31                            31 
##                    삼양사거리                          삼전 
##                            31                            31 
##                          상갈                          상계 
##                            31                            31 
##                          상도                          상동 
##                            31                            31 
##                        상록수          상봉(시외버스터미널) 
##                            31                            62 
##                          상수                      상왕십리 
##                            31                            31 
##    상월곡(한국과학기술연구원)                        상일동 
##                            31                            31 
##                          상천                    새절(신사) 
##                            31                            31 
##                          샛강                        서강대 
##                            31                            31 
##                        서대문                        서동탄 
##                            31                            31 
##                        서빙고          서울대입구(관악구청) 
##                            31                            31 
##                        서울숲                        서울역 
##                            31                           156 
##                        서정리                          서초 
##                            31                            31 
##                          서현                          석계 
##                            31                            62 
##                          석수                          석촌 
##                            31                            62 
##                      석촌고분                          선릉 
##                            31                            62 
##                        선바위                        선유도 
##                            31                            31 
##                        선정릉                      성균관대 
##                            62                            31 
##                          성수            성신여대입구(돈암) 
##                            31                            62 
##                          성환                          세류 
##                            31                            31 
##                          세마                    세종대왕릉 
##                            31                            31 
##                      소래포구                          소사 
##                            31                            31 
##                        소요산                      솔밭공원 
##                            31                            31 
##                          솔샘                          송내 
##                            31                            31 
##                          송도                          송정 
##                            31                            31 
##                          송탄                          송파 
##                            31                            31 
##                      송파나루                          수내 
##                            31                            31 
##                        수락산                        수리산 
##                            31                            31 
##                          수색                          수서 
##                            31                            62 
##                          수원                      수원시청 
##                            62                            31 
##                수유(강북구청)                          수진 
##                            31                            31 
##                숙대입구(갈월)            숭실대입구(살피재) 
##                            31                            31 
##                          숭의                          시청 
##                            31                            62 
##                          신갈                        신금호 
##                            31                            31 
##                          신길                      신길온천 
##                            62                            31 
##                          신내                        신논현 
##                            36                            31 
##                          신답                          신당 
##                            31                            62 
##                        신대방                  신대방삼거리 
##                            31                            31 
##                        신도림                    신둔도예촌 
##                            62                            31 
##                          신림                        신목동 
##                            31                            31 
##                        신반포                        신방화 
##                            31                            31 
##                          신사                        신설동 
##                            31                            93 
##                        신용산                          신원 
##                            31                            31 
##                        신이문                  신정(은행정) 
##                            31                            31 
##                    신정네거리                        신중동 
##                            31                            31 
##                신창(순천향대)                          신촌 
##                            31                            62 
##                          신포                          신풍 
##                            31                            31 
##                          신흥                          쌍문 
##                            31                            31 
##                쌍용(나사렛대)                          아산 
##                            31                            31 
##                          아신      아차산(어린이대공원후문) 
##                            31                            31 
##                          아현                          안국 
##                            31                            31 
##                          안산              안암(고대병원앞) 
##                            31                            31 
##                          안양                          암사 
##                            31                            31 
##                        압구정                  압구정로데오 
##                            31                            31 
##                        애오개                          야당 
##                            31                            31 
##                          야탑                          약수 
##                            31                            62 
##                          양수                          양원 
##                            31                            31 
##                양재(서초구청)                          양정 
##                            31                            31 
##                          양주                      양천구청 
##                            31                            31 
##                      양천향교                          양평 
##                            31                            62 
##          어린이대공원(세종대)                          언주 
##                            31                            31 
##                      여의나루                        여의도 
##                            31                            62 
##                          여주                          역곡 
##                            31                            31 
##                          역삼                          역촌 
##                            31                            31 
##                          연수                        연신내 
##                            31                            46 
##                          염창                        영등포 
##                            31                            31 
##                    영등포구청                    영등포시장 
##                            62                            31 
##                          영종                          영통 
##                            31                            31 
##                          오금                        오류동 
##                            62                            31 
##                          오리          오목교(목동운동장앞) 
##                            31                            31 
##                          오빈                          오산 
##                            31                            31 
##                        오산대                        오이도 
##                            31                            31 
##                          옥수            온수(성공회대입구) 
##                            62                            62 
##                      온양온천          올림픽공원(한국체대) 
##                            31                            62 
##              왕십리(성동구청)                        외대앞 
##                            93                            31 
##                          용답              용두(동대문구청) 
##                            31                            31 
##          용마산(용마폭포공원)                          용문 
##                            31                            31 
##                          용산                        우장산 
##                            31                            31 
##                        운길산                          운서 
##                            31                            31 
##                          운정                          원당 
##                            31                            31 
##                          원덕                        원인재 
##                            31                            31 
##                          원흥                          월계 
##                            31                            31 
##                월곡(동덕여대)                          월곶 
##                            31                            31 
##            월드컵경기장(성산)                          월롱 
##                            31                            31 
##                     을지로3가                     을지로4가 
##                            62                            62 
##                    을지로입구                          응봉 
##                            31                            31 
##                          응암                          의왕 
##                            31                            31 
##                        의정부                          이대 
##                            31                            31 
##                          이매                          이수 
##                            62                            31 
##                          이천          이촌(국립중앙박물관) 
##                            31                            62 
##                        이태원                        인덕원 
##                            31                            31 
##                          인천               인천공항1터미널 
##                            62                            31 
##               인천공항2터미널                      인천논현 
##                            31                            31 
##                        인하대                          일산 
##                            31                            31 
##                          일원                        임진강 
##                            31                            31 
##                잠실(송파구청)                      잠실나루 
##                            62                            31 
##                      잠실새내                          잠원 
##                            31                            31 
##                      장승배기                          장암 
##                            31                            31 
##                          장지                        장한평 
##                            31                            31 
##                          정릉                        정발산 
##                            31                            31 
##                  정부과천청사                          정왕 
##                            31                            31 
##                          정자                        제기동 
##                            31                            31 
##                        제물포                          종각 
##                            31                            31 
##                       종로3가                       종로5가 
##                            93                            31 
##                    종합운동장                          주안 
##                            62                            31 
##                          주엽                          죽전 
##                            31                            31 
##                          중계                          중곡 
##                            31                            31 
##                          중동                          중랑 
##                            31                            31 
##                          중앙                  중앙보훈병원 
##                            31                            31 
##                          중화                          증미 
##                            31                            31 
##                증산(명지대앞)                          지제 
##                            31                            31 
##                          지축                          지평 
##                            31                            31 
##                          지행                          직산 
##                            31                            31 
##                          진위                          창동 
##                            31                            41 
##                          창신                        천마산 
##                            31                            31 
##                          천안                          천왕 
##                            31                            31 
##                천호(풍납토성)                          철산 
##                            62                            31 
##                          청구                          청담 
##                            62                            31 
##                  청라국제도시        청량리(서울시립대입구) 
##                            31                            62 
##                          청명                          청평 
##                            31                            31 
##                          초월                          초지 
##                            31                            31 
##              총신대입구(이수)                          춘의 
##                            31                            31 
##                          춘천                        충무로 
##                            31                            51 
##            충정로(경기대입구)                          탄현 
##                            62                            31 
##                      태릉입구                          태평 
##                            62                            31 
##                        퇴계원                          파주 
##                            31                            31 
##                          판교                          팔당 
##                            31                            31 
##                      평내호평                          평촌 
##                            31                            31 
##                          평택                          풍산 
##                            31                            31 
##                          하계                          학동 
##                            31                            31 
##                        학여울                        한강진 
##                            31                            31 
##                          한남                        한대앞 
##                            31                            31 
##            한성대입구(삼선교)                      한성백제 
##                            31                            31 
##                        한양대                          한티 
##                            31                            31 
##                          합정                          행당 
##                            62                            31 
##                          행신                          혜화 
##                            31                            31 
##                        호구포                      홍대입구 
##                            31                            93 
##                          홍제                          화계 
##                            31                            31 
##                          화곡          화랑대(서울여대입구) 
##                            31                            31 
##                          화서                          화전 
##                            31                            31 
##                          화정                          회기 
##                            31                            31 
##                          회룡              회현(남대문시장) 
##                            31                            31 
##                    효창공원앞              흑석(중앙대입구) 
##                            62                            31
```

```r
# 너무 많다 하아...
```
#### (4) on_passenger, off_passenger 변수로 전체승객 변수 만들기


```r
subway$total_passenger<-subway$on_passenger+subway$off_passenger
```

### 5) 분석 데이터 최종 확인


```r
str(subway)
```

```
## 'data.frame':	18327 obs. of  7 variables:
##  $ date           : int  20200501 20200501 20200501 20200501 20200501 20200501 20200501 20200501 20200501 20200501 ...
##  $ line           : chr  "중앙선" "중앙선" "중앙선" "중앙선" ...
##  $ station        : chr  "운길산" "팔당" "도심" "덕소" ...
##  $ on_passenger   : int  1349 1492 1691 4303 645 6006 9135 967 5584 4606 ...
##  $ off_passenger  : int  1358 1712 1462 4233 599 5562 9495 992 5317 4431 ...
##  $ day            : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ total_passenger: int  2707 3204 3153 8536 1244 11568 18630 1959 10901 9037 ...
```

## 2. 데이터 분석

### 1) 역의 하루 평균 승차, 하차 승객수


```r
subway%>%
  summarise(on_m=mean(on_passenger),
            off_m=mean(off_passenger))
```

```
##       on_m    off_m
## 1 9008.591 8977.572
```

### 2) 승차승객수가 가장 많았던 역의 노선을 찾아보기


```r
max(subway$on_passenger)        # 승차승객의 최댓값
```

```
## [1] 92741
```

```r
subway%>%
  filter(on_passenger==92741)%>%   # 승차승객이 최대인 데이터 추출
  select(date, line, station, on_passenger)   # 4개 변수만 선택
```

```
##       date  line station on_passenger
## 1 20200508 2호선    강남        92741
```

```r
# subway %>% 
#  filter(on_passenger==max(on_passenger)) %>% 
#    select(date, line, station, on_passenger) 두과정을 합친 경우
```

### 3) 역별 하루 평균 전체승객수 분석


```r
passenger10<-subway%>%
  group_by(station)%>%
  summarise(m=mean(total_passenger))%>%
  arrange(desc(m))%>%
  head(10)

head(passenger10, 3)
```

```
## # A tibble: 3 x 2
##   station              m
##   <chr>            <dbl>
## 1 강남           138946.
## 2 신림           105798.
## 3 구로디지털단지  95262.
```
### 4) 역별 하루 평균 전체승객수가 많은 10개 역을 막대 그래프로 그리기


```r
ggplot(data = passenger10, aes(x=reorder(station, m), y=m))+
  geom_col()+
  coord_flip()
```

![](/images/Example_10_2_files/figure-html/unnamed-chunk-13-1.png)<!-- -->

### 5) 날짜별 전체승객 분석


```r
subway %>%
  group_by(date)%>%
  summarise(total=sum(total_passenger))%>%
  arrange(desc(total))%>%
  head(3)
```

```
## # A tibble: 3 x 2
##       date    total
##      <int>    <int>
## 1 20200508 13585022
## 2 20200529 13358885
## 3 20200522 13356365
```

### 6) 1호선 분석


```r
subway %>%
  filter(line=="1호선")%>%
  filter(total_passenger==max(total_passenger))%>%
  select(date, station, on_passenger, off_passenger, total_passenger)
```

```
##       date station on_passenger off_passenger total_passenger
## 1 20200508  서울역        49277         47873           97150
```

### 7) 주중과 휴일의 전체승객 비교


```r
subway$week <-ifelse(subway$day %in% c(2,3,5,9,10,16,17,23,24,30,31),
                    "weekend","weekday")
t.test(data=subway, total_passenger~week)
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  total_passenger by week
## t = 38.314, df = 18238, p-value < 2.2e-16
## alternative hypothesis: true difference in means between group weekday and group weekend is not equal to 0
## 95 percent confidence interval:
##  8850.746 9805.159
## sample estimates:
## mean in group weekday mean in group weekend 
##              21295.00              11967.05
```

```r
# p-value 값이 0.05보다 작기 때문에 주중과 휴일의 전체승객수는 통계적으로 차이가 있다.
# 주중 전체승객수가 주말보다 많다.
```

### 8) 노선별 전체승객 비율 비교


```r
line_pct <- subway%>%
  group_by(line)%>%                                          # line별로 분류
  summarise(total=sum(total_passenger))%>%                   # line별로 이용승객 총계 
  mutate(all=sum(total),                                    # 전체 line의 이용승객 총계
         pct=round(total/all*100, 2))                        # line별 이용승객 비율

line_pct%>%
  arrange(desc(pct))%>%
  head(3)
```

```
## # A tibble: 3 x 4
##   line     total       all   pct
##   <chr>    <int>     <int> <dbl>
## 1 2호선 66416505 329632420 20.2 
## 2 7호선 33342484 329632420 10.1 
## 3 5호선 28570030 329632420  8.67
```


### 9) 지하철 전체승객 비율 막대그래프 그리기


```r
line_pct10 <- line_pct%>%
  filter(line %in% c("1호선","2호선","3호선","4호선","5호선","6호선","7호선","8호선","9호선","분당선"))

ggplot(data=line_pct10,aes(x=reorder(line,pct),y=pct))+
  geom_col()+
  coord_flip()+
  ggtitle("서울지하철 노선별 이용비율")+
  xlab("노선")+
  ylab("이용비율율")
```

![](/images/Example_10_2_files/figure-html/unnamed-chunk-18-1.png)<!-- -->

### 10) 날짜별 전체승객 선그래프 그리기


```r
line_graph <- subway%>%
  group_by(day)%>%
  summarise(s=sum(total_passenger))

ggplot(data=line_graph,aes(x=day, y=s, group=1))+
  geom_line()+
  ggtitle("수도권 지하철 요일별 이용승객수")+
  xlab("요일")+
  ylab("이용승객객")
```

![](/images/Example_10_2_files/figure-html/unnamed-chunk-19-1.png)<!-- -->


## 연습문제 10 - 2

### 1. 4호선 혜화역의 하루 평균 승차객수, 하차객수, 전체승객수를 알아보겠습니다.


```r
subway%>%
  filter(station=="혜화")%>%
  summarise(on_m=mean(on_passenger),
            off_m=mean(off_passenger),
            total_m=mean(total_passenger))
```

```
##       on_m    off_m total_m
## 1 25275.29 26046.71   51322
```

### 2. 5월 5일은 어린이날입니다. 이날 롯데월드가 있는 잠실역의 전체승객수를 구해봅니다.


```r
subway%>%
  filter(date==20200505 & station=="잠실(송파구청)")%>%
  select(line, station, on_passenger, off_passenger, total_passenger)
```

```
##    line        station on_passenger off_passenger total_passenger
## 1 2호선 잠실(송파구청)        40446         37954           78400
## 2 8호선 잠실(송파구청)         8801          9855           18656
```

### 3. 서울역에는 1호선, 4호선, 경부선, 경의선, 공항철도 1호선 등 5개 노선이 있습니다. 1호선과 4호선 서울역의 하루 평균 전체승객수를 구하고, 통계적으로 차이가 있는가를 검정 하세요.


```r
seoul_station <- subway%>%
  filter(station=="서울역" & line %in% c("1호선","4호선"))

t.test(data=seoul_station, total_passenger~line)
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  total_passenger by line
## t = 12.711, df = 38.818, p-value = 2.056e-15
## alternative hypothesis: true difference in means between group 1호선 and group 4호선 is not equal to 0
## 95 percent confidence interval:
##  39342.28 54234.88
## sample estimates:
## mean in group 1호선 mean in group 4호선 
##            67811.87            21023.29
```

```r
# p값이 0.001보다 작기 때문에 통계적으로 신뢰성이 있다.
# 1호선 하루 평균 전체승객은 6만7811.87명이고, 4호선은 2만 1023.29명이다.
```

### 4. 매월 1 ~ 10일은 초순, 11 ~ 20일은 중순, 21일 이후는 하순이다. 초순, 중순, 하순별로 1개 역의 하루 평균 전체승객수를 구해서 새 객체 period_passenger에 입력한 후에 내림차순으로 출력합니다.


```r
subway$period<-ifelse(subway$day<=10,"first",
                     ifelse(subway$day<=20,"second","third"))
period_passenger<-subway%>%
  group_by(period)%>%
  summarise(m=mean(total_passenger))
arrange(period_passenger,desc(m))
```

```
## # A tibble: 3 x 2
##   period      m
##   <chr>   <dbl>
## 1 second 19493.
## 2 third  18655.
## 3 first  15743.
```

### 5. 막대그래프로 그립니다.


```r
ggplot(data=period_passenger, aes(x=period, y=m))+
  geom_col()+
  scale_x_discrete(limits=c("first","second","third"))
```

![](/images/Example_10_2_files/figure-html/unnamed-chunk-24-1.png)<!-- -->



















